<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Parameter Estimation for Spliced Distributions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for fitSplicedBayes {OpVaR}"><tr><td>fitSplicedBayes {OpVaR}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Parameter Estimation for Spliced Distributions
</h2>

<h3>Description</h3>

<p>MCMC based parameter estimation for spliced distribution functions, where the body is modeled by a Weibull, gamma or log-normal distribution or Kernel density estimation for a log-normal distribution and the tail is fitted with a GPD.
</p>


<h3>Usage</h3>

<pre>
fitSplicedBayesWeibullGPD(cell, prior, burnin=10, niter=100, 
proposal_scale=evmix::fweibullgpd(cell,method="Nelder-Mead")$se, 
start=evmix::fweibullgpd(cell,method="Nelder-Mead")$optim$par)

fitSplicedBayesGammaGPD(cell, prior, burnin=10, niter=100, 
proposal_scale=evmix::fgammagpd(cell,method="Nelder-Mead")$se, 
start=evmix::fgammagpd(cell,method="Nelder-Mead")$optim$par)

fitSplicedBayesLognormGPD(cell, prior, burnin=10, niter=100, 
proposal_scale=evmix::flognormgpd(cell,method="Nelder-Mead")$se, 
start=evmix::flognormgpd(cell,method="Nelder-Mead")$optim$par)

fitSplicedBayesKDEGPD(cell, prior, burnin=10, niter=100, 
proposal_scale=evmix::flognormgpd(cell,method="Nelder-Mead")$se, 
start=evmix::flognormgpd(cell,method="Nelder-Mead")$optim$par)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>cell</code></td>
<td>

<p>database for the parameter estimation
</p>
</td></tr>
<tr valign="top"><td><code>prior</code></td>
<td>

<p>parameters of the particular prior distribution
</p>
</td></tr>
<tr valign="top"><td><code>burnin</code></td>
<td>

<p>length of the burn-in-phase, standard value = 10
</p>
</td></tr>
<tr valign="top"><td><code>niter</code></td>
<td>

<p>MCMC sample size, standard value = 100
</p>
</td></tr>
<tr valign="top"><td><code>proposal_scale</code></td>
<td>

<p>respective scale values used for determining the prior distribution for each parameter
</p>
</td></tr>
<tr valign="top"><td><code>start</code></td>
<td>

<p>starting values (shapes) for the MH-algorithm steps 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input contains the dataset, whose compound distribution should be fitted with the function. The second part of the input is a list with the parameters of the prior distribution. It is necessary to indicate the <code>prior</code> as a list containing the full parameter vector in the order <code>bodypar_1=c(),bodypar_2=c(), threshold=c(), beta=c(), xi=c()</code>, where <code>bodypar_1</code> and <code>bodypar_2</code> are the parameters of the body (Weibull: wshape and wscale as shape and scale parameter, log-norm: mu and sigma, gamma: gshape and gscale as shape and scale parameter).<code>threshold</code> is the threshold seperating the distributions.<code>beta</code> and <code>xi</code> are the scale and shape parameters of the generalized Pareto distribution.
Using the MH-algorithm the true parameters of the body and tail distribution should be approximated. 
</p>


<h3>Value</h3>

<p>Sevdist object containing the parameters of the target distribution.
</p>


<h3>Author(s)</h3>

<p>Kristina Dehler, Nicole Derfuss
</p>


<h3>References</h3>

<p>Behrens, C. N.; Lopes, H. F.; Gamerman, D. (2004). Bayesian analysis of extreme events with threshold estimation. Statistical Modelling 4, 227-244.
</p>
<p>Dehler, K. (2017). Bayesianische Methoden im operationellen Risiko. Master's thesis.
</p>
<p>Ergashev, B.; Mittnik, S.; Sekeris, E. (2013). A Bayesian Approach to Extreme Value Estimation in Operational Risk Modeling. The Journal of Operational Risk 8(4), 55-81.
</p>
<p>MacDonald, A.; Scarrott, C.J.; Lee, D.; Darlow, B.; Reale, M.; Russell, G. (2011). A flexible extreme value mixture model. Computational Statistics and Data Analysis 55(6), 2137-2157.
</p>


<h3>See Also</h3>

<p>Read <code><a href="buildSplicedSevdist.html">buildSplicedSevdist</a></code> for further information about building sevdist objects with type &quot;spliced&quot;. The initial parameter values are fitted using the methods from the package 'evmix', i.e. for the WeibullGPD the function <code><a href="../../evmix/html/fweibullgpd.html">fweibullgpd</a></code>. For the algorithm also the package 'truncnorm' is required.
</p>


<h3>Examples</h3>

<pre>
### Example for estimating the parameters of the spliced Weibull-GPD

## Not run: 

data("lossdat")
data=lossdat[[1]]$Loss

## starting values - method of moments

# Weibull distribution (shape, scale)
model &lt;- function(x) c(F1 = x[2]*gamma(1+1/x[1])-mean(data),
	F2 = x[2]^2*(gamma(1+2/x[1])-(gamma(1+1/x[1]))^2)-sd(data)^2)
weibullpar &lt;- rootSolve::multiroot(f = model,start = c((sd(data)/mean(data))^(-1.086),
	mean(data)/(gamma(1+1/((sd(data)/mean(data))^(-1.086))))))$root

# generalized Pareto distribution (tresh, beta, xi)
thresh=quantile(data,.9) # threshold
data2=data[which(data&gt;thresh)]
model=function(x) c(F1=thresh+x[1]/(1-x[2])-mean(data2),
	F2=x[1]^2/(1-x[2])^2/(1-2*x[2])-sd(data2)^2)
gpdpar=c(thresh,rootSolve::multiroot(f=model,start=c(mean(data2),1/mean(data2)))$root)

## parameters of the prior distribution

prior &lt;- list(xi = c(gpdpar[3],sd(data)),tau = c(quantile(data,.9),sd(data)/10),
	beta = c(gpdpar[2],sd(data)),wscale = c(weibullpar[2],sd(data)),
	wshape = c(weibullpar[1],sd(data)))

## estimation of (shape, scale, thresh, beta, xi)

fitSplicedBayesWeibullGPD(data, prior = prior, proposal_scale = evmix::fweibullgpd(data, 
	method = "Nelder-Mead", pvector = c(weibullpar[1], weibullpar[2], gpdpar[1], 
	gpdpar[2], gpdpar[3]))$se, start = evmix::fweibullgpd(data, 
	method = "Nelder-Mead", pvector = c(weibullpar[1], weibullpar[2], gpdpar[1], 
	gpdpar[2], gpdpar[3]))$optim$par)

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>OpVaR</em> version 1.1.1 <a href="00Index.html">Index</a>]</div>
</body></html>
